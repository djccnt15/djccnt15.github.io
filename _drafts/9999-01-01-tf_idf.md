---
published: true
layout: post
title: '[TextMining] TF-IDF'
description: >
    단어의 중요도를 파악하는 방법
categories: [DataAnalysis]
tags: [data analysis, text mining, konlpy]
image:
    path: /assets/img/posts/thumbnail_konlpy.png
related_posts:
    - _posts/data_science/2022-06-16-installing_konlpy.md
---
* toc
{:toc}

## 개요

단어의 등장 순서를 고려하지 않는 빈도수 기반 자연어 처리 모델을 **bag of words model(단어 가방 모형)**이라고 하는데, 이 bag of words 모델에서는 TF와 IDF를 결합한 TF-IDF값을 통해 단어의 중요도를 파악한다.  

## BoW

**Bag of Words**란 단어들의 출현 빈도에만 집중하는 텍스트 데이터의 수치화 표현 방법이다.  

```python
from typing import List

from konlpy.tag import Okt


def bag_of_words(doc: str, stopwords: list) -> tuple:
    """returns index of words and bag of words"""

    okt = Okt()
    doc = doc.replace('.', '')
    tokenized_doc = okt.morphs(doc)  # tokenize doc by morpheme
    word_index = {}
    bow: List[int] = []

    for word in tokenized_doc:
        if word in stopwords:  # pass stop words
            continue

        elif word not in word_index.keys():  # add word to word_index
            word_index[word] = len(word_index)
            bow.append(1)

        else:  # count word
            index: int = word_index[word]
            bow[index] += 1

    return word_index, bow


stop_words = ['은', '는', '이', '가', '의', '을', '를', '들']

corpus = [
    '중소 기업들의 디지털전환 전략',
    '스마트공장 지원을 통한 제조 기업의 디지털전환',
    '전체 제조 기업 중 중소 기업이 95% 이상을 차지함',
    '전체 제조 기업 종사자 중 중소 기업 종사자가 70% 이상을 차지함',
]

doc = ' '.join(corpus)
vocabs, bag_of_word = bag_of_words(doc=doc, stopwords=stop_words)

print(vocabs)
print(bag_of_word)
```
```
{'중소': 0, '기업': 1, '디지털': 2, '전환': 3, '전략': 4, '스마트': 5, '공장': 6, '지원': 7, '통한': 8, '제조': 9, '전체': 10, '중': 11, '95%': 12, '이상': 13, '차지': 14, '함': 15, '종사': 16, '자': 17, '70%': 18}
[3, 6, 2, 2, 1, 1, 1, 1, 1, 3, 2, 2, 1, 2, 2, 2, 2, 2, 1]
```

`bag_of_words()` 함수는 [딥 러닝을 이용한 자연어 처리 입문](https://wikidocs.net/22650)에 있는 코드를 일부 개선했다.  

## TF

**TF(Term Frequency, 단어 빈도)**는 단어에서 유추할 수 있듯이 특정한 단어가 문서 내에 얼마나 자주 등장하는지를 나타내는 값으로, 기본적으로 이 값이 높을수록 문서에서 중요하다고 판단할 수 있다. 아래 문장들에 대해 TF값을 계산해보자.  

- 중소 기업들의 디지털전환 전략
- 스마트공장 지원을 통한 제조 기업의 디지털전환
- 전체 제조 기업 중 중소 기업이 95% 이상을 차지함
- 전체 제조 기업 종사자 중 중소 기업 종사자가 70% 이상을 차지함

## IDF

단어의 중요도는 기본적으로 TF를 통해서 파악할 수 있다. 그러나 영어의 관사나 한국어의 조사와 같이 문서군 내에서 매우 자주 사용 되는 단어가 오히려 전혀 중요하지 않은 단어일 가능성이 있는데, 따라서 단어의 중요도 가중치를 보정해주기 위한 방법이 필요하다. 이 때 사용되는 방법이 **DF(Document Frequency, 문서 빈도)**로, 특정 단어가 몇 개의 문서에 등장했는지에 대한 정보이다.  

TF의 가중치 보정을 위해 DF에 역수를 취한 것이 **[IDF(Inverse Document Frequency)](https://www.researchgate.net/publication/238123710_Understanding_Inverse_Document_Frequency_On_Theoretical_Arguments_for_IDF)**로, IDF의 계산에는 여러 가지 방법이 있으나, 최근 연구들은 대부분 아래와 같이 계산한다고 한다.  

$$idf(d, t) = \log \left( \frac{n}{1 + df(t)} \right)$$

계산 결과에 log를 취하는 이유는 문서의 크기 n이 커질수록 IDF값이 기하급수적으로 커지는 것을 방지하기 위해서이고, 분모에 1을 더하는 이유는 특정 단어가 전체 문서에서 등장하지 않을 경우에 분모가 0이 되는 상황을 방지하기 위한 것이라고 한다.  

## TF-IDF

---
## Reference
- [위키피디아: 단어 가방 모형](https://ko.wikipedia.org/wiki/%EB%8B%A8%EC%96%B4_%EA%B0%80%EB%B0%A9_%EB%AA%A8%ED%98%95)([영문](https://en.wikipedia.org/wiki/Bag-of-words_model))
- [위키피디아: TF-IDF](https://ko.wikipedia.org/wiki/Tf-idf)([영문](https://en.wikipedia.org/wiki/Tf%E2%80%93idf))
- [딥 러닝을 이용한 자연어 처리 입문](https://wikidocs.net/book/2155)
- [Understanding Inverse Document Frequency: On Theoretical Arguments for IDF](https://www.researchgate.net/publication/238123710_Understanding_Inverse_Document_Frequency_On_Theoretical_Arguments_for_IDF)