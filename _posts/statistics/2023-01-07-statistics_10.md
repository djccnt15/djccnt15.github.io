---
published: true
layout: post
title: '[기초통계학] 10. 다양한 이산확률분포'
description: >
    베르누이 분포, 이항분포, 초기하분포
categories: [Statistics]
tags: [statistics]
image:
    path: /assets/img/posts/thumbnail_statistics_10.png
related_posts:
    - _posts/statistics/2023-01-01-statistics_09.md
---
{% include series_statistics.html %}
* toc
{:toc}

## 1. 베르누이 분포

다음의 조건을 만족하는 실험을 **베르누이 시행(Bernoulli trial)**이라 한다.  

- 각 실험에서 발생 가능한 결과가 단 두 가지
- 각 실험은 독립적으로 수행
- 모든 실험에서 결과의 확률은 항상 동일

💡 모집단이 충분히 크고 표본크기가 상대적으로 크지 않은 경우 비복원추출도 베르누이 실험을 근사모형으로 사용 가능하다.  
{:.note}

모수(parameter)인 성공 확률이 $$p$$인 베르누이 시행의 확률변수의 분포를 **베르누이 분포(Bernoulli distribution)**라 하고, 아래와 같이 표기한다.  

$$X \sim B(p)$$

베르누이 분포의 확률질량함수의 일반식은 아래와 같다.  

$$f(x) = P(X = x) = p^{x}(1 - p)^{1 - x}, \quad x = 0, \ 1$$

베르누이 분포의 기대값과 분산은 아래와 같다.  

$$\begin{align*}
& E(X) = 0 \times (1 - p) + 1 \times p = p \\
\\
& E(X^{2}) = 0^{2} \times (1 - p) + 1^{2} \times p = p \\
\\
& Var(X) = p - p^{2} = p(1 - p) \\
\\
& SD(X) = \sqrt{p(1 - p)}
\end{align*}$$

## 2. 이항분포

성공 확률이 $$p$$인 베르누이 실험을 $$n$$번 반복했을 때, 성공 횟수 $$X$$의 분포를 **이항분포(binomial distribution)**라 한다.  

$$X_{i} \sim B(p)$$라고 할 때, 성공 횟수 $$X$$는 $$n$$개의 베르누이 확률변수의 합으로 표시한다.  

$$X = X_{1} + X_{2} + \cdots + X_{n}$$

따라서 이를 바탕으로 이항분포의 기대값과 분산을 유도하면 아래와 같다.  

$$\begin{align*}
E(X_{i}) = p \ & \to \ E(X) = np \\
\\
Var(X_{i}) = p(1 - p) \ & \to \ Var(X) = np(1 - p) \\
\\
SD(X_{i}) = \sqrt{p(1 - p)} \ & \to \ SD(X) = \sqrt{np(1 - p)}
\end{align*}$$

시행횟수를 $$n$$, 성공확률 $$p$$인 이항분포를 아래와 같이 표기한다.  

$$X \sim B(n, p)$$

이항분포의 확률질량함수의 일반식은 아래와 같다.  

$$f(x) = \binom{n}{x}p^{x}(1 - p)^{n - x}, \quad x = 0, 1, \cdots, n$$

$$X \sim B(m, p), Y \sim B(n, p)$$이고 $$X, Y$$가 독립인 경우 이항분포의 결합은 아래와 같다.  

$$X + Y \sim B(m + n, p)$$

## 3. 초기하분포

각 실험에서 발생 가능한 결과가 단 두 가지이고, 크기가 $$N$$인 모집단(유한모집단)이 각각 $$M$$과 $$N - M$$ 크기의 부모집단 $$A, B$$로 나뉘어진 경우에서 $$n$$개의 표본을 무작위로 비복원추출할 때, 부모집단 $$A$$에서 추출된 표본 수의 분포를 **초기하분포(hypergeometric distribution)**라 한다.  

초기하분포의 확률질량함수의 일반식은 아래와 같다.  

$$f(x) = \frac{\binom{M}{x}\binom{N - M}{n - x}}{\binom{N}{n}}, \quad x = max(0, n - N + M), \cdots, min(n, M)$$

$$N$$이 크고 $$N$$에 비해 $$n$$이 상대적으로 매우 작은 경우($$n \ll N$$) 비복원의 효과가 적기 때문에 베르누이 실험으로 근사하며, 따라서 초기하분포 역시 $$p = M/N$$인 이항분포로 근사한다.  

초기하분포의 기대값과 분산은 아래와 같다.  

$$\begin{align*}
E(X) & = n \frac{M}{N} = np \\
\\
Var(X) & = np(1 - p) - n(n - 1)\frac{p(1 - p)}{N - 1} \\
& = np(1 - p)\frac{N - n}{N - 1} = n\frac{M}{N} \left( 1 - \frac{M}{N} \right) \leq np(1 - p)
\end{align*}$$

<details><summary>초기하분포 기대값과 분산의 유도</summary><div markdown="1">

$$E(X_{i}) = \frac{M}{N} = p \ \to \ E(X) = n \frac{M}{N} = np$$

$$\begin{align*}
E(X_{i}) & = \frac{M}{N} = p, \quad E(X_{i}^{2}) = \frac{M}{N} = p \\
\\
\therefore Var(X_{i}) & = p - p^{2} = p(1 - p) = \frac{M}{N}\frac{N - M}{N} \\
\\
\therefore Var(X) & = \sum_{i}Var(X_{i}) + 2\sum_{i < j}Cov(X_{i}, X_{j}) \\
\\
Cov(X_{i}, X_{j}) & = E(X_{i}X_{j}) - E(X_{i})E(X_{j}) \\
\\
E(X_{i}X_{j}) & = P(X_{i} = 1, X_{j} = 1) \quad \because X_{i} = 0 \ \to \ E(X_{i}X_{j}) = 0 \\
& = P(X_{i} = 1)P({X_{j} = 1 \vert X_{i} = 1}) = \frac{M}{N}\frac{M - 1}{N - 1} \\
\\
\therefore Cov(X_{i}, X_{j}) & = \frac{M}{N}\frac{M - 1}{N - 1} - \left( \frac{M}{N} \right)^{2} \\
& = -\frac{M}{N}\frac{N - M}{N(N - 1)} = -\frac{p(1 - p)}{N - 1} \leq 0 \\
\\
\therefore Var(X) & = np(1 - p) - n(n - 1)\frac{p(1 - p)}{N - 1} \\
& = np(1 - p)\frac{N - n}{N - 1}
\end{align*}$$

</div></details><br>

이 때 위 식에서 $$\frac{N - n}{N - 1}$$을 유한모집단 수정계수라 한다.  

유한모집단으로부터 비복원 추출을 하면서 분산이 작아진다는 것은 퍼져있는 정도가 작아져 데이터의 변동성이 적어진다는 것을 의미하고, 이를 바탕으로 모수를 추정했을 때 더 안정적인 형태를 갖는다는 것을 의미한다.  

---
## Reference
- [구현한 함수 git repository](https://github.com/djccnt15/mathematics)