---
published: true
layout: post

title: '[SQL] 06. SQL ê¸°ë³¸ - 2'
description: >
    SQL ê¸°ë³¸: WHERE, í•¨ìˆ˜
hide_description: false
image:
    path: /assets/img/posts/sql_06.png
related_posts:
    - _posts/programming/2022-08-11-sql_05.md

categories:
    - Programming
tags:
    - programming
    - SQL
---
* toc
{:toc}

## 1. WHERE

### 1-1. WHERE ê°œìš”

`WHERE`ë¥¼ ì‚¬ìš©í•´ì„œ ì¡°ì¸ ì¡°ê±´ì´ë‚˜ ì¡°íšŒ ê²°ê³¼ë¥¼ ì œí•œí•˜ê¸° ìœ„í•œ ì¡°ê±´ì„ ìž‘ì„±í•  ìˆ˜ ìžˆë‹¤.  

```sql
SELECT [COL_NAME] [ALIAS] FROM [TD_NAME] WHERE [CONDITIONS];
```

ì¡°ê±´ì‹ì˜ êµ¬ì„±ì€ ì•„ëž˜ì™€ ê°™ë‹¤.  

- ì¹¼ëŸ¼(Column)ëª… (ë³´í†µ ì¡°ê±´ì‹ì˜ ì¢Œì¸¡ì— ìœ„ì¹˜)
- ë¹„êµ ì—°ì‚°ìž
- ë¬¸ìž, ìˆ«ìž, í‘œí˜„ì‹ (ë³´í†µ ì¡°ê±´ì‹ì˜ ìš°ì¸¡ì— ìœ„ì¹˜)
- ë¹„êµ ì¹¼ëŸ¼ëª… (JOIN ì‚¬ìš©ì‹œ)

### 1-2. ì—°ì‚°ìž

#### ì—°ì‚°ìžì˜ ì¢…ë¥˜

`WHERE`ì ˆì˜ ì¡°ê±´ì‹ì— ì‚¬ìš©ë˜ëŠ” ì—°ì‚°ìžë“¤ì€ ì•„ëž˜ì™€ ê°™ë‹¤.  

- ë¹„êµ/ë¶€ì • ë¹„êµ ì—°ì‚°ìž
    - `=`, `>`, `>=`, `<`, `<=`
    - `!=`, `^=`, `<>`, `NOT [COL_NAME] =`, `NOT [COL_NAME] >`, `NOT [COL_NAME] <`
- SQL/ë¶€ì • SQL ì—°ì‚°ìž
    - `BETWEEN a AND b`, `IN (list)`, `LIKE 'regex'`, `IS NULL`
    - `NOT BETWEEN a AND b`, `NOT IN (list)`, `IS NOT NULL`
- ë…¼ë¦¬ ì—°ì‚°ìž
    - `AND`, `OR`, `NOT`

ðŸ’¡ ì°¸ê³ ë¡œ `BETWEEN a AND b`ëŠ” `a <= n <= b`ë¥¼ ëœ»í•œë‹¤.  
{:.note}

`LIKE` ì—°ì‚°ì˜ ê²½ìš° `%`, `_` ë“±ì˜ ì™€ì¼ë“œ ì¹´ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.  

- `%`: 0ê°œ ì´ìƒì˜ ì•„ë¬´ ë¬¸ìž
- `_`: 1ê°œì¸ ë‹¨ì¼ ë¬¸ìž

ðŸ’¡ `NULL`ê°’ê³¼ì˜ ìˆ˜ì¹˜ ì—°ì‚°ì€ `NULL`, ë¹„êµ ì—°ì‚°ì€ `FALSE`ë¥¼ ë¦¬í„´í•œë‹¤.  
{:.note}

#### ì—°ì‚°ìžì˜ ìš°ì„  ìˆœìœ„

0. ê´„í˜¸ `()`
0. NOT ì—°ì‚°ìž
0. ë¹„êµ ì—°ì‚°ìž, SQL ì—°ì‚°ìž
0. AND
0. OR

### 1-3. ROWNUM, TOP

Oracleì˜ `ROWNUM`ê³¼ MSSQLì˜ ê²½ìš° `TOP`ì€ Pseudo Columnìœ¼ë¡œì¨ SQL ì²˜ë¦¬ ê²°ê³¼ì˜ ê° í–‰ì— ëŒ€í•´ ìž„ì‹œë¡œ ë¶€ì—¬ë˜ëŠ” ì¼ë ¨ë²ˆí˜¸ë¥¼ ë§í•œë‹¤. `WHERE`ì ˆì—ì„œ í–‰ì˜ ê°œìˆ˜ë¥¼ ì œí•œí•˜ëŠ” ëª©ì ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.  

```sql
-- Oracle
SELECT [COL_NAME] FROM [TD_NAME] WHERE ROWNUM <= [NUM];

-- MSSQL
SELECT TOP([Expression]) [PERCENT] [COL_NAME] FROM [TD_NAME] WITH TIES;
```

- Expression: ë°˜í™˜í•  í–‰ì˜ ìˆ˜ë¥¼ ì§€ì •
- PERCENT: ì¿¼ë¦¬ ê²°ê³¼ì—ì„œ Expression%ì˜ í–‰ë§Œ ë°˜í™˜
- WITH TIES: ORDER BY ì ˆì´ ì§€ì •ëœ ê²½ìš°ì—ë§Œ ì‚¬ìš©í•  ìˆ˜ ìžˆìŒ. ë™ì¼í•œ ë°ì´í„°ê°€ ìžˆì„ ê²½ìš° í•¨ê»˜ ì¶œë ¥ë¨

## 2. í•¨ìˆ˜

### 2-1. ë¬¸ìží˜• í•¨ìˆ˜

ë¬¸ìží˜• í•¨ìˆ˜ì˜ ì¢…ë¥˜ëŠ” ì•„ëž˜ì™€ ê°™ë‹¤. `/` í‘œì‹œê°€ ìžˆìœ¼ë©´ ì•žì´ Oracle, ë’¤ê°€ MSSQLì´ë‹¤.  

- `LOWER('STR')`, `UPPER('STR')`
    - ëŒ€/ì†Œë¬¸ìž ë³€ê²½
- `ASCII('STR')`
    - ë¬¸ìžë¥¼ ASCII ì½”ë“œë¡œ ë³€ê²½
- `CHR/CHAR(ASCII)`
    - ASCII ì½”ë“œë¥¼ ë¬¸ìžë¡œ ë³€ê²½
- `CONCAT('STR1', 'STR2')`
    - 'STR1'ê³¼ 'STR2'ì„ ì—°ê²°. [í•©ì„±ì—°ì‚°ìž](/programming/sql_05/#3-5-ì—°ì‚°ìž)ì™€ ë™ì¼
- `SUBSTR/SUBSTRING('STR', m[n])`
    - ë¬¸ìžì—´ì˜ m ìœ„ì¹˜ì—ì„œ nê°œì˜ ë¬¸ìž ê¸¸ì´ì— í•´ë‹¹í•˜ëŠ” ë¬¸ìžë¥¼ ë°˜í™˜. nì´ ìƒëžµë˜ë©´ ë§ˆì§€ë§‰ ë¬¸ìžê¹Œì§€ ë°˜í™˜
- `LENGTH/LEN('STR')`
    - ë¬¸ìžì—´ì˜ ê°œìˆ˜ ë°˜í™˜
- `LTRIM`, `RTRIM('STR', 'TARGET_STR')`
    - ì²« ë¬¸ìž/ë§ˆì§€ë§‰ ë¬¸ìžë¶€í„° í™•ì¸í•´ì„œ ì§€ì • ë¬¸ìžê°€ ë‚˜íƒ€ë‚˜ëŠ” ë™ì•ˆ í•´ë‹¹ ë¬¸ìž ì œê±°
    - MSSQLì—ì„œëŠ” ì§€ì • ë¬¸ìžë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê³  ê³µë°±ë§Œ ì œê±° ê°€ëŠ¥í•¨
- `TRIM([LEADING/TRAILING/BOTH] 'TARGET_STR' FROM 'STR')`
    - ë¬¸ìžì—´ì—ì„œ ë¨¸ë¦¬ë§, ê¼¬ë¦¬ë§ ë˜ëŠ” ì–‘ìª½ì˜ ì§€ì • ë¬¸ìž ì œê±°
    - MSSQLì—ì„œëŠ” ì§€ì • ë¬¸ìžë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê³  ê³µë°±ë§Œ ì œê±° ê°€ëŠ¥í•¨

### 2-2. ìˆ«ìží˜• í•¨ìˆ˜

ìˆ«ìží˜• í•¨ìˆ˜ì˜ ì¢…ë¥˜ëŠ” ì•„ëž˜ì™€ ê°™ë‹¤. `/` í‘œì‹œê°€ ìžˆìœ¼ë©´ ì•žì´ Oracle, ë’¤ê°€ MSSQLì´ë‹¤.  

- `ABS(NUM)`
    - ì ˆëŒ€ê°’ ë°˜í™˜
- `SIGN(NUM)`
    - ë¶€í˜¸ ë°˜í™˜
- `MOD(NUM1, NUM2)`, `%`
    - NUM1ì„ NUM2ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ ì—°ì‚°
- `CEIL/CEILING(NUM)`
    - NUM ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì€ ìµœì†Œ ì •ìˆ˜ ë°˜í™˜
- `FLOOR(NUM)`
    - NUM ë³´ë‹¤ ìž‘ê±°ë‚˜ ê°™ì€ ìµœëŒ€ ì •ìˆ˜ ë°˜í™˜
- `ROUND(NUM [m])`
    - ìˆ«ìžë¥¼ ì†Œìˆ˜ì  m ìžë¦¬ì—ì„œ ë°˜ì˜¬ë¦¼. mì˜ defaultëŠ” 0
- `TRUNC(NUM [m])`
    - ìˆ«ìžë¥¼ ì†Œìˆ˜ì  m ìžë¦¬ì—ì„œ ë²„ë¦¼. mì˜ defalutëŠ” 0
    - MSSQLì—ì„œëŠ” ë¯¸ì œê³µ
- `SIN(NUM)`, `COS(NUM)`, `TAN(NUM)`
    - ì‚¼ê°í•¨ìˆ˜ ê°’ ë°˜í™˜
- `EXP(NUM)`, `POWER(NUM)`, `SQRT(NUM)`, `LOG(NUM)`, `LN(NUM)`
    - ìˆ«ìžì˜ ì§€ìˆ˜, ì œê³±, ì œê³±ê·¼, ìžì—°ë¡œê·¸ ê°’ ë°˜í™˜

### 2-3. ë‚ ì§œí˜• í•¨ìˆ˜

DATE íƒ€ìž…ì˜ ê°’ì„ ì—°ì‚°í•˜ëŠ” ë‚ ì§œí˜• í•¨ìˆ˜ì˜ ì¢…ë¥˜ëŠ” ì•„ëž˜ì™€ ê°™ë‹¤. `/` í‘œì‹œê°€ ìžˆìœ¼ë©´ ì•žì´ Oracle, ë’¤ê°€ MSSQLì´ë‹¤.  

- `SYSDATE/GETDATA()`
    - í˜„ìž¬ ë‚ ì§œì™€ ì‹œê°„ ì¶œë ¥
- `EXTRACT('YEAR'/'MONTH'/'DAY' from d)/DATEPART('YEAR'/'MONTH'/'DAY', d)`
    - ë‚ ì§œ ë°ì´í„°ì—ì„œ ë…„/ì›”/ì¼/ì‹œê°„/ë¶„/ì´ˆ ë°ì´í„°ë¥¼ ì¶”ì¶œ
- `TO_NUMBERS(TO_CHAR(d, 'YYYY'))/YEAR(d)`, `TO_NUMBERS(TO_CHAR(d, 'MM'))/MONTH(d)`, `TO_NUMBERS(TO_CHAR(d, 'DD'))/DAY(d)`
    - ë‚ ì§œ ë°ì´í„°ì—ì„œ ë…„/ì›”/ì¼/ì‹œê°„/ë¶„/ì´ˆ ë°ì´í„°ë¥¼ ì¶”ì¶œ

ë°ì´í„°ë² ì´ìŠ¤ëŠ” ë‚ ì§œë¥¼ ìˆ«ìžë¡œ ì €ìž¥í•˜ê¸° ë•Œë¬¸ì— ì•„ëž˜ì™€ ê°™ì€ ì‚°ìˆ  ì—°ì‚°ì´ ì ìš© ê°€ëŠ¥í•˜ë‹¤.  

- ë‚ ì§œ +/- ìˆ«ìž
- ë‚ ì§œ1 - ë‚ ì§œ2: ë‘ ë‚ ì§œì˜ ì°¨ì´ì— í•´ë‹¹í•˜ëŠ” ì¼ìˆ˜
- ë‚ ì§œ + ìˆ«ìž/24: ë‚ ì§œì— ì‹œê°„ì„ ë”í•¨

### 2-4. ë³€í™˜í˜• í•¨ìˆ˜

ë³€í™˜í˜• í•¨ìˆ˜ëŠ” íŠ¹ì • ë°ì´í„° íƒ€ìž…ì„ ë‹¤ì–‘í•œ í˜•ì‹ìœ¼ë¡œ ì¶œë ¥í•˜ê³  ì‹¶ì„ ê²½ìš°ì— ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜ë¡œ, ëª…ì‹œì (Explicit) ë³€í™˜ê³¼ ì•”ì‹œì (Implicit) ë³€í™˜ì´ ìžˆë‹¤.  

Oracleì˜ ëŒ€í‘œì ì¸ ë³€í™˜í˜• í•¨ìˆ˜ëŠ” ì•„ëž˜ì™€ ê°™ë‹¤.  

- `TO_NUMBERS('STR)`
    - ë¬¸ìžì—´ì„ ìˆ«ìžë¡œ ë³€í™˜
- `TO_CHAR(NUM/DATE [FORMAT])`
    - ìˆ«ìžë‚˜ ë‚ ì§œë¥¼ FORMAT í˜•íƒœì˜ ë¬¸ìžì—´ë¡œ ë³€í™˜
- `TO_DATE('STR', [FORMAT])`
    - ë¬¸ìžì—´ì„ ì£¼ì–´ì§„ FORMAT í˜•íƒœì˜ ë‚ ì§œë¡œ ë³€í™˜

MSSQLì˜ ëŒ€í‘œì ì¸ ë³€í™˜í˜• í•¨ìˆ˜ëŠ” ì•„ëž˜ì™€ ê°™ë‹¤.  

- `CAST([Expression] AS [DATATYPE](LENGTH))`
    - Expressionì„ ëª©í‘œ ë°ì´í„° íƒ€ìž…ìœ¼ë¡œ ë³€í™˜
- `CONVERT([DATATYPE](LENGTH) [Expression] [STYLE])`
    - Expressionì„ ëª©í‘œ ë°ì´í„° íƒ€ìž…ìœ¼ë¡œ ë³€í™˜

### 2-5. CASE í‘œí˜„

CASE í‘œí˜„ì€ ì¼ë°˜ ë²”ìš©í”„ë¡œê·¸ëž˜ë° ì–¸ì–´ì˜ ì¡°ê±´ë¬¸ê³¼ ë¹„ìŠ·í•˜ê²Œ, ì¡°ê±´ì— ë”°ë¼ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.  

```sql
CASE
    WHEN [SIMPLE_CASE_EXPRESSION] THEN [RES]
    ELSE [RES]
END
```

```sql
CASE
    WHEN [SEARCHED_CASE_EXPRESSION] THEN [RES]
    ELSE [RES]
END
```

```sql
DECODE([COL_NAME], [Expression_1], [RES_1], [Expression_2], [RES_2], ..., [DEFAULT]);
```

DECODE í•¨ìˆ˜ì˜ ê²½ìš° Oracleì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.  

### 2-6. NVL, ISNULL

`NULL`ê°’ê³¼ì˜ ìˆ˜ì¹˜ ì—°ì‚°ì€ `NULL`, ë¹„êµ ì—°ì‚°ì€ `FALSE`ë¥¼ ë¦¬í„´í•˜ëŠ”ë°, ê²°ê³¼ê°’ì„ `NULL`ì´ ì•„ë‹Œ ë‹¤ë¥¸ ê°’ì„ ì–»ê³ ìž í•  ë•Œ `NVL`/`ISNULL` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. `/` í‘œì‹œê°€ ìžˆìœ¼ë©´ ì•žì´ Oracle, ë’¤ê°€ MSSQLì´ë‹¤.  

- `NVL/ISNULL([Expression_1, Expression_2])`
    - Expression_1ì˜ ê²°ê³¼ê°’ì´ `NULL`ì´ë©´ Expression_2ë¥¼ ì¶œë ¥
    - Expression_1ê³¼ Expression_2ì˜ ê²°ê³¼ ë°ì´í„° íƒ€ìž…ì´ ê°™ì•„ì•¼ í•¨
- `NULLIF([Expression_1, Expression_2])`
    - Expression_1ê³¼ Expression_2ê°€ ê°™ìœ¼ë©´ `NULL`, ë‹¤ë¥´ë©´ Expression_1ì„ ë°˜í™˜
- `COALESCE([Expression_1, Expression_2])`
    - ì£¼ì–´ì§„ Expression ì¤‘ `NULL`ì´ ì•„ë‹Œ ìµœì´ˆì˜ Expressionì„ ë°˜í™˜
    - ëª¨ë“  Expressionì´ `NULL`ì´ë©´ `NULL` ë°˜í™˜

---
## Reference
- [WHERE ì ˆ](https://dataonair.or.kr/db-tech-reference/d-guide/sql/?pageid=4&mod=document&uid=341)
- [í•¨ìˆ˜(FUNCTION)](https://dataonair.or.kr/db-tech-reference/d-guide/sql/?pageid=4&mod=document&uid=342)