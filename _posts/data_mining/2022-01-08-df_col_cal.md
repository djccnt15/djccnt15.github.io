---
title: "DataFrame 칼럼 연산"
excerpt: "pandas DataFrame의 칼럼 연산"
published: true

toc: true
toc_sticky: true

categories:
  - data mining
tags:
  - python
  - data mining
  - pandas
---
# {{ page.excerpt }}
---
`pandas`의 칼럼 연산을 잘 활용하면 데이터 전처리가 정말 편해진다.  

```python
import pandas as pd

a = [1, 2, 3, 4]

df = pd.DataFrame()
df['a'], df['b'] = a, a

print(df)
```

```markdown
   a  b
0  1  1
1  2  2
2  3  3
3  4  4
```

특정 칼럼의 조건에 따라 다른 작업을 수행하게 하고 싶으면 아래와 같이 하면 된다.  

```python
# 칼럼 a의 값이 2보다 작거나 같을 때 칼럼 c에 칼럼 a와 칼럼 b의 곱을 입력
df.loc[df['a'] <= 2, 'c'] = df['a'] * df['b']

print(df)
```

```markdown
   a  b    c
0  1  1  1.0
1  2  2  4.0
2  3  3  NaN
3  4  4  NaN
```

```python
# 칼럼 a의 값이 2보다 클 때 칼럼 c에 칼럼 a와 칼럼 b의 합을 입력
df.loc[df['a'] > 2, 'c'] = df['a'] + df['b']

print(df)
```

```markdown
   a  b    c
0  1  1  1.0
1  2  2  4.0
2  3  3  6.0
3  4  4  8.0
```

---
# Alternatives
- [numpy select](../np_select) 활용
- [numpy where](../np_where) 활용